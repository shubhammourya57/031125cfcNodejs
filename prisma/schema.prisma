
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
   password  String
  sessionId String? @unique
  createdAt DateTime @default(now())

 
  individualMessagesSent     IndividualMessage[] @relation("SentIndividualMessages")
  individualMessagesReceived IndividualMessage[] @relation("ReceivedIndividualMessages")


  groupMessagesSent GroupMessage[] @relation("SentGroupMessages")

  groupMembers GroupMember[]
}

model IndividualMessage {
  id         Int      @id @default(autoincrement())
  senderId   Int
  receiverId Int
  message    String
  createdAt  DateTime @default(now())

  sender   User @relation("SentIndividualMessages", fields: [senderId], references: [id])
  receiver User @relation("ReceivedIndividualMessages", fields: [receiverId], references: [id])
}

model Group {
  id        Int             @id @default(autoincrement())
  name      String
  createdAt DateTime        @default(now())
  members   GroupMember[]
  messages  GroupMessage[]
}

model GroupMember {
  id        Int      @id @default(autoincrement())
  userId    Int
  groupId   Int
  joinedAt  DateTime @default(now())

  user  User  @relation(fields: [userId], references: [id])
  group Group @relation(fields: [groupId], references: [id])
}

model GroupMessage {
  id        Int      @id @default(autoincrement())
  senderId  Int
  groupId   Int
  message   String
  createdAt DateTime @default(now())

  sender User  @relation("SentGroupMessages", fields: [senderId], references: [id])
  group  Group @relation(fields: [groupId], references: [id])
}
